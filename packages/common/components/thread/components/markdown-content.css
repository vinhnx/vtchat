/* Markdown content styling with improved readability and accessibility */

/* Define CSS variables for consistent styling */
:root {
  /* Light theme colors */
  --markdown-text-color: #111827; /* Dark gray for better contrast than pure black */
  --markdown-heading-color: #000000; /* Pure black for headings */
  --markdown-link-color: #2563eb; /* Accessible blue */
  --markdown-code-bg: #f3f4f6; /* Light gray background for inline code */
  --markdown-blockquote-color: #4b5563; /* Medium gray for blockquotes */
  --markdown-blockquote-border: #d1d5db; /* Light gray border for blockquotes */
  --markdown-table-border: #e5e7eb; /* Light gray for table borders */
  --markdown-table-header-bg: #f9fafb; /* Very light gray for table headers */
  --markdown-hr-color: #e5e7eb; /* Light gray for horizontal rules */
  
  /* Spacing */
  --markdown-paragraph-spacing: 1.25rem;
  --markdown-list-spacing: 0.5rem;
  --markdown-heading-spacing: 1.75rem;
}

/* Dark theme overrides */
.dark {
  --markdown-text-color: #f3f4f6; /* Light gray for better readability than pure white */
  --markdown-heading-color: #ffffff; /* Pure white for headings */
  --markdown-link-color: #60a5fa; /* Lighter blue for dark mode */
  --markdown-code-bg: #374151; /* Dark gray background for inline code */
  --markdown-blockquote-color: #9ca3af; /* Light gray for blockquotes */
  --markdown-blockquote-border: #4b5563; /* Medium gray border for blockquotes */
  --markdown-table-border: #374151; /* Dark gray for table borders */
  --markdown-table-header-bg: #1f2937; /* Darker gray for table headers */
  --markdown-hr-color: #374151; /* Dark gray for horizontal rules */
}

/* Base text styling */
.prose {
  font-size: 1rem;
  line-height: 1.75;
  max-width: 65ch; /* Optimal reading width */
}

/* Paragraph styling */
.prose p {
  color: var(--markdown-text-color) !important;
  margin-bottom: var(--markdown-paragraph-spacing);
  line-height: 1.75;
  transition: color 0.2s ease;
}

/* Heading styling with proper hierarchy */
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  color: var(--markdown-heading-color) !important;
  font-weight: 600;
  line-height: 1.25;
  margin-top: var(--markdown-heading-spacing);
  margin-bottom: 0.75rem;
  transition: color 0.2s ease;
}

.prose h1 {
  font-size: 2rem;
  margin-top: 0;
}

.prose h2 {
  font-size: 1.5rem;
  border-bottom: 1px solid var(--markdown-hr-color);
  padding-bottom: 0.5rem;
}

.prose h3 {
  font-size: 1.25rem;
}

.prose h4 {
  font-size: 1.125rem;
}

/* List styling */
.prose ul,
.prose ol {
  margin-top: 1rem;
  margin-bottom: 1rem;
  padding-left: 1.5rem;
}

.prose li {
  color: var(--markdown-text-color) !important;
  margin-top: var(--markdown-list-spacing);
  margin-bottom: var(--markdown-list-spacing);
  transition: color 0.2s ease;
}

.prose ul > li {
  list-style-type: disc;
}

.prose ol > li {
  list-style-type: decimal;
}

/* Nested lists */
.prose ul ul,
.prose ol ul {
  list-style-type: circle;
  margin-top: 0.5rem;
}

.prose ul ul ul,
.prose ol ul ul {
  list-style-type: square;
}

/* Link styling */
.prose a:not(.anchor) {
  color: var(--markdown-link-color) !important;
  text-decoration: underline;
  text-underline-offset: 2px;
  transition: all 0.2s ease;
}

.prose a:not(.anchor):hover {
  text-decoration: none;
}

/* Blockquote styling */
.prose blockquote {
  color: var(--markdown-blockquote-color) !important;
  border-left: 4px solid var(--markdown-blockquote-border);
  padding-left: 1rem;
  font-style: italic;
  margin: 1.5rem 0;
}

.prose blockquote p {
  color: var(--markdown-blockquote-color) !important;
}

/* Code styling */
.prose code:not([class*="language-"]) {
  color: var(--markdown-text-color);
  background-color: var(--markdown-code-bg);
  padding: 0.2rem 0.4rem;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

/* Table styling */
.prose table {
  width: 100%;
  table-layout: auto;
  text-align: left;
  margin-top: 1.5rem;
  margin-bottom: 1.5rem;
  border-collapse: collapse;
}

.prose thead {
  background-color: var(--markdown-table-header-bg);
}

.prose th {
  padding: 0.75rem 1rem;
  font-weight: 600;
  color: var(--markdown-text-color) !important;
  border-bottom: 2px solid var(--markdown-table-border);
}

.prose td {
  padding: 0.75rem 1rem;
  color: var(--markdown-text-color) !important;
  border: 1px solid var(--markdown-table-border);
  vertical-align: top;
}

/* Horizontal rule */
.prose hr {
  border: 0;
  border-top: 1px solid var(--markdown-hr-color);
  margin: 2rem 0;
}

/* Strong and emphasis */
.prose strong {
  color: var(--markdown-heading-color) !important;
  font-weight: 600;
}

.prose em {
  color: var(--markdown-text-color) !important;
  font-style: italic;
}

/* Images */
.prose img {
  margin: 1.5rem 0;
  border-radius: 0.375rem;
  max-width: 100%;
  height: auto;
}

/* Ensure proper text color in error messages with transitions */
.markdown-text {
  color: var(--markdown-text-color) !important;
  transition: color 0.2s ease;
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  .prose *,
  .markdown-text {
    transition: none !important;
  }
}

/* High contrast mode improvements */
@media (forced-colors: active) {
  .prose a:not(.anchor) {
    text-decoration: underline !important;
  }
  
  .prose blockquote {
    border-left-color: CanvasText;
  }
}

/* Force immediate color update on theme change */
html.light .markdown-text,
html.light .prose p,
html.light .prose li,
html.light .prose h1,
html.light .prose h2,
html.light .prose h3,
html.light .prose h4,
html.light .prose h5,
html.light .prose h6,
html.light .prose strong,
html.light .prose em,
html.light .prose blockquote,
html.light .prose td,
html.light .prose th {
  color: var(--markdown-text-color) !important;
}

html.dark .markdown-text,
html.dark .prose p,
html.dark .prose li,
html.dark .prose h1,
html.dark .prose h2,
html.dark .prose h3,
html.dark .prose h4,
html.dark .prose h5,
html.dark .prose h6,
html.dark .prose strong,
html.dark .prose em,
html.dark .prose blockquote,
html.dark .prose td,
html.dark .prose th {
  color: var(--markdown-text-color) !important;
}
